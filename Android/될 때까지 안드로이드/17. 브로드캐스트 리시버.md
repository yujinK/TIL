## 17. 브로드캐스트 리시버

> 방송하는 주체와 방송을 듣는 리시버가 존재
>
> 방송은 액티비티(Activity)나 서비스(Service) 같은 4대 컴포넌트 중 하나가 인텐트를 통해 발송
>
> 발송된 방송은 브로드캐스트 리시버(BroadcastReciever) 객체가 수신



### 17.1 미리 정의된 방송

- 안드로이드 기기 내부에서는 각 상황에 따라 미리 정의된 방송을 발송

- 개발자는 앱에서 해당 방송 액션(Action)을 수신하여 적절한 처리 수행
- BroadcastReciever : 방송들을 수신하는 객체

- 방송을 수신하는 방법
  - 매니페스트 파일에 \<receiver\> 요소로 정의 
    - 기기에서 발송되는 모든 방송 수신 가능
  - 자바 코드로 동적으로 리시버를 등록, 해제
    - 특정 상황에만 동작하는 리시버 작성 가능



#### 17.1.1 글로벌 방송 수신

- 매니페스트 파일에 브로드캐스트 리시버를 정의하여 모든 방송을 수신

- onReceive()
  - 각 방송 정보 인텐트로 전달됨
  - 인텐트를 전달받으려면 매니페스트 파일에 인텐트 필터 등록
- 안드로이드 오레오 버전부터는 앱이 동작하는 중에만 방송 수신 가능
  - 암시적 인텐트를 리시버가 수신할 수 없게 됨
  - 시스템에서 허용하는 액션들만 글로벌 브로드캐스트로 등록 가능



#### 17.1.2 로컬 방송 수신

- 앱이 동작하는 중에만 방송을 수신
- 일반적으로 리시버 등록과 해제는 onResume() 또는 onStart() 메서드에 등록, onPause() 또는 onStop() 메서드에서 해제
  - registerReceiver()
  - unregisterReceiver()





### 17.2 사용자 정의 방송

- 미리 정의된 방송이 아닌 새로운 방송을 정의, 수신 가능



#### 17.2.1 나만의 방송 보내기

- sendBroadcast()
  - 인텐트에 나만의 액션명을 발송할 수 있음



#### 17.2.2 나만의 방송 수신하기

- onReceive()
- 임의로 만든 액션은 안드로이드 오레오 버전부터 로컬 브로드캐스트로만 수신 가능
  - 로컬로 나만의 액션을 인텐트 필터에 등록





### 17.3 브로드캐스트 리시버의 특징

1. 순서가 보장되지 않는다
   - sendOrderedBroadcast()를 사용하여 발송한 방송은 순서가 보장됨
2. 같은 방송을 수신하는 리시버들의 우선순위
   - 특별한 설정을 하지 않을 때에는 시스템이 알아서 적당히 분배
   - 무조건 다른 리시버들보다 먼저 방송을 수신해야 한다면 priority 속성 설정
3. 방송이 더 이상 전파되지 않도록 막기
   - abortBroadcast() 호출
     - 자신보다 낮은 우선순위를 가진 리시버는 더 이상 이 방송을 수신할 수 없음



