# 기본 모듈과 Node.js 기초

## 노드의 모듈 개념

- 노드로 개발한 `애플리케이션을 이루는 기본 조각`
- 물건을 만들 때 쓰는 부품
  - 미리 만들어진 파트들을 조립해서 물건을 만드는 것처럼, 관련된 코드들을 모아서 캡슐화해놓은 것
- 일반적으로 노드로 개발된 애플리케이션은 객체 지향의 개념이 아주 잘 녹아 있는 자바스크립트를 기반으로 하여, 파일과 1:1 맵핑이 되는 다양한 모듈로 구성    





### 노드의 모듈화 개념

- 노드는 확장성을 위해 <u>모듈</u> 구조를 통해 애플리케이션을 구성
  - 애플리케이션을 이루는 기본 단위
  - 보통 다수의 클래스와 이를 통해 생성한 객체 등으로 구성
- 모듈 단위로 구성된다는 것은 `객체 지향 컨셉으로 애플리케이션이 구성`된다는 것을 의미
  - 노드가 CommonJS의 스펙을 대부분 준수하기 때문
- 노드의 모듈은 자바스크립트 파일 하나와 1:1 맵핑
- 노드의 모듈은 `CommonJS 모듈 스펙으로부터 많은 영향을 받아 구현`되었지만 완벽하게 같진 않음    





### 전역 객체의 개념

- 전역 객체 : 어디에서나 사용할 수 있는 객체
- 클라이언트 자바스크립트에서는 window나 document와 같은 객체를 전역 객체라고 말할 수 있음
- 서버 사이드에서 동작하는 노드의 경우 `"global"`이라는 전역 객체가 존재
  - require(), setTimeout(), console.log() 등을 포함    





### 모듈의 종류

- `기본 모듈, 확장 모듈` : 노드 설치 시 기본적으로 설치되어 있는지에 대한 유무
- `일반 모듈, 네이티브 모듈` : C/C++ 등의 다른 언어로 작성하고 빌드하여 개발하였는지
- `글로벌 모듈, 로컬 모듈` : 현재 웹 애플리케이션을 위해서만 사용하기 위해 설치했는지

<img src="https://grm-project-template-bucket.s3.ap-northeast-2.amazonaws.com/lesson/les_KjQPd_1488432999945/1488434081136_image.png">    





### 기본 모듈과 확장 모듈

- 기본 모듈
  - 노드를 설치하면 기본으로 설치되는 모듈
  - 파일 입출력, 이벤트 관리, HTTP 프로토콜 관리 등에 관한 내용으로써 노드의 비동기 입출력 처리를 위한 기본적인 기능들을 제공하는 모듈
- 확장 모듈
  - 노드의 기능을 확장하기 위한 것
  - 좀 더 쉬운 HTTP 서버 생성, 기본 파일 입출력에서 제공하지 않는 기능 추가 등
  - 노드를 확장하고 더 편리하게 사용하기 위한 모듈
  - express와 같은 모듈들처럼 하나의 프레임워크로서 제공되기도 하며, mongodb를 사용하기 위한 mongoose나 mongolian처럼 다른 기술을 손쉽게 끌어와 사용할 수 있게 도와주는 역할을 하기도 함    





### 일반 모듈과 네이티브 모듈

- 개발 방법에 따라 나눌 수 있는 내용
- 네이티브 모듈
  - 네이티브 프로그래밍 언어인 C/C++로 노드의 모듈을 개발한 경우
  - 확장 모듈 또한 네이티브 모듈로 개발 가능
  - `.node`라는 확장자를 가졌으면 네이티브 모듈로 컴파일된 것이라고 보면 됨
- 일반 모듈
  - 노드의 모듈 인터페이스를 통해 간단히 자바스크립트로 개발된 모듈
- 같은 기능을 수행하는 네이티브 모듈 / 일반 모듈 중 대체로 네이티브 모듈이 더 나은 성능을 보임    





### 글로벌 모듈과 로컬 모듈

- 글로벌 모듈
  - 기본 모듈을 포함하여 어디서든 사용할 수 있도록 설치한 확장 모듈
- 로컬 모듈
  - 해당 애플리케이션에서만 사용하기 위해 설치한 확장 모듈이나 개발자가 개발한 모듈
- 확장 모듈을 글로벌 모듈로 사용하려면 설치 시 특별한 옵션(-g)을 이용    





### 복합 모듈

- 내부 모듈이나 데이터 파일, 템플릿, 테스트 코드 등을 포함하는 모듈
- 다양한 파일을 포함하기 때문에 모듈을 구성하는 단위가 폴더이며 내부적으로도 폴더를 가질 수 있음
- require() 메소드가 이런 폴더 단위의 모듈을 인식하려면 index.js 파일이나 package.json 파일 중 하나가 반드시 있어야 함    





### 모듈 식별자

- 노드의 모듈 이름으로는 확장자 없는 전체 경로를 사용

- 모듈을 파일과 일대일로 대응하기 때문에 .js나 .node라는 확장자를 가지지만 모듈을 불러들일 때는 파일 이름만 사용하면 되기 때문
- 모듈의 식별자 종류
  - 상대적 식별자
    - 현재 위치를 기준으로 상대적인 기준에 있는 모듈을 찾는 식별자
    - 유닉스 시스템의 상대경로와 유사하나 ./를 생략하면 현재 위치에서 모듈을 찾지 않으니 주의
    - require('./sample_module');
  - 절대적 식별자
    - 절대 위치를 기준으로 그 경로에 맞는 모듈을 찾는 식별자
    - 유닉스 시스템에서 절대 경로와 비슷
    - require('/usr/local/node_modules/sample_module/sample_module');
  - 최상위 레벨 식별자
    - 아무것도 입력하지 않고 모듈 이름만 입력하면 최상위 레벨 식별자로 인식하고 설치된 전체 확장 모듈이나 기본 모듈 중에서 해당 모듈 이름을 검색하여 로드
    - require('sample_module');
    - 모듈 식별자를 찾는 순서 !!중요!!
      - 만약 sample_module이라는 모듈이 기본모듈에서 찾을 수 없는 모듈이라면 상위 디렉토리를 차례대로 검색
      - 다음과 같은 순서로 탐색
        - /home/goorm/example_project/node_modules/sample_module.js
        - /home/goorm/node_modules/sample_module.js
        - /home/node_modules/sample_module.js
        - /node_modules/sample_module.js    





### require() 메소드와  module.exports

- 노드는 서로 다른 자바스크립트 파일들이 서로 참조하고 호출되는 방법이 필요
- require() 메소드
  - 모듈 식별자인 module.exports를 이용해 모듈이 제공하는 함수나 객체 등을 반환
  - 만약 불러온 모듈이 다른 모듈이 있어야 한다면 그 모듈도 같이 로드 -> **노드 모듈화에서 핵심**

- 모듈을 사용하는 파일에서는 require() 메소드로 다른 자바스크립트 파일을 불러와서 module.exports로 허용된 변수나 함수를 사용할 수 있음    





## 전역 객체 : Global

### Console 객체

- 콘솔화면과 관련된 기능
- log를 제외하면 잘 쓰이지 않음
  - console.log() : 콘솔에 로그 메시지 출력
  - console.time(label) : 시간 측정 시작
  - console.timeEnd(label) : 시간 측정 종료
- log로 출력 시 지정한 포맷보다 변수가 많으면 그대로 출력하고 부족하다면 특수 문자를 출력

``````javascript
console.log('%d + %d = %d', 1, 2, 1+2);
// 1 + 2 = 3

console.log('%d + %d = %d', 1, 2, 1+2, 4);
// 1 + 2 = 3 4

console.log('%d + %d = %d', 1, 2);
// 1 + 2 = %d

console.time('time');
console.timeEnd('time');
// time: 0.172ms
``````

​    



### Process 객체

- 프로그램과 관련된 기능을 다루는 객체
- 자바스크립트에는 없는, Node.js만의 객체
- 속성
  - process.argv : 프로그램의 매개변수 정보
  - process.env : 컴퓨터 환경과 관련된 정보
  - process.version : Node.js의 버전
  - process.versions : Node.js 프로세스에서 사용하는 모듈들의 버전
  - process.arch : 프로세서의 아키텍처
  - process.platform : 플랫폼의 정보
- 메소드
  - process.exit() : 프로그램 종료
  - process.memoryUsage() : 메모리 사용 정보
  - process.uptime() : 현재 프로그램이 실행된 시간

``````javascript
console.log('process env property : ', process.env);
console.log('uptime method : ', process.uptime());
``````

​    



### Exports 객체

- 모듈 관련 객체
- Node.js는 Exports 객체를 사용하여 기능을 확장 가능
- 모듈의 기능을 쉽게 사용하기 위해 메소드와 속성을 미리 정의해서 모아 놓은 것
- 자바의 클래스나 라이브러리와 비슷
- 모듈을 생성하려면 파일을 만들고, exports 객체의 속성이나 메소드로 정의. 만들어진 모듈은 전역 함수 require()을 이용하여 추출

``````javascript
exports.double = function(r) {
    return r * r;
};

exports.plus = function(r) {
    return r + r;
};
``````

``````javascript
var calculator = require('./test.js');
console.log('Double value is ' + calculator.double(3));
console.log('Plus value is ' + calculator.plus(3));
``````

